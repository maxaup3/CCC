# Canvas Agent — 用无限画布完成一份 PPT

> 产品设计文档 | 2026-01-29 | 内部开发 Spec

## 1. 产品概述

Canvas Agent 是一个基于无限画布的 AI 协作工具。用户在画布上与 Agent 协作完成复杂任务——Agent 负责搜索、分析、整理，将产出物作为独立卡片放到画布上；用户负责筛选、组织、决策，通过画布操作（而不只是打字）与 Agent 沟通。

**与 CLI/对话式 AI 的本质差异：**

| | 对话式 AI | Canvas Agent |
|--|----------|-------------|
| 产出物 | 一段文字，读完就滚走 | 独立卡片，留在画布上，可拖、可删、可展开 |
| 上下文 | 线性聊天记录，越聊越长 | 空间布局，所有内容同时可见 |
| 用户操作 | 只能打字 | 选中、框选、拖拽、删除、标注——画布操作即沟通 |
| 多内容对比 | 翻聊天记录 | 拖到一起并排看 |
| 信任验证 | 看文字里有没有引用 | 来源标记、一键查看完整报告和原文 |

**验证场景：用 Agent 完成一份竞品分析 PPT。** PPT 天然是空间化的（每页是一张卡片），涉及多内容、多修改、多模态——正好是画布比对话擅长的任务类型。

## 2. 核心设计原则

从之前的设计探索和原型实现中，确认了以下原则：

**1. 产出物是主角，过程是配角**
用户要的是结果。Agent 的思考、工具调用等过程信息**不上画布**——只在输入栏状态条里用一句话表示进度。用户需要追溯时，通过产出物上的来源标记回溯。

**2. 每个产出物是独立的画布对象**
不是一张汇总列表，而是每个产品/内容一张卡片。用户可以单独删除、拖动、展开、深入研究。这是画布比对话提供的核心新价值。

**3. 信息层级：扫一眼 → 快速校验 → 深入阅读**
卡片默认只显示最少信息（名称+一句话+标签）。底部来源摘要让用户快速校验可信度。展开或弹窗查看完整报告和原文链接。

**4. 画布操作即沟通**
文本输入是辅助。删除 = "不要这个"，框选 = "基于这些做什么"，拖到一起 = "对比这些"。用户的空间操作本身就是给 Agent 的指令。

**5. 多任务并行，不阻塞用户**
用户可以同时下多个任务（"收集竞品" + "搜索相关论文"），每个任务独立执行、独立显示进度。输入框始终可用。

**6. 用户是画布的主人**
Agent 负责生产并放上去，用户负责组织和管理。Agent 不会替用户做布局决策，产出物放在合理的默认位置，用户自己安排最终结构。

## 3. 完整路径：用画布做一份竞品分析 PPT

用户说：「帮我做一份画布产品的竞品分析 PPT」

### 3.1 阶段一：任务理解与拆解

**用户输入：**「帮我做一份画布产品的竞品分析 PPT」

**Agent 行为：**

Agent 接到任务后，按"能确定的先做、不确定的先问"的原则处理（和人类协作者一样）：

1. **判断哪些可以直接开始**：搜索画布类产品 → 可以直接做，不需要确认
2. **判断哪些需要用户决策**：PPT 的受众是谁？汇报给领导还是团队分享？→ 影响内容深度和风格，需要问
3. **判断哪些是补充信息**：有没有要重点覆盖的产品？→ 有更好，没有也能做

**提示分级与呈现位置：**

| 级别 | 含义 | 呈现方式 | 位置 | 用户行为 |
|------|------|---------|------|---------|
| **强提示** | 影响任务结果的决策，不决定会浪费算力和时间 | 输入栏上方浮层，带选项按钮 | 屏幕底部，挡在输入栏前 | 必须选择才继续 |
| **弱提示** | 补充信息，有了更好 | Comment 气泡，钉在相关内容上 | 画布上，附着在相关卡片 | 用户有空时回应 |
| **无需提示** | Agent 能自己判断 | 不提示，直接执行 | — | 用户随时可纠正 |

**这个阶段的具体交互：**

```
用户：帮我做一份画布产品的竞品分析 PPT

Agent（内部判断）：
  - 搜索画布产品 → 可以直接做 ✓
  - PPT 受众？→ 影响结果，需要问 → 强提示
  - 有无重点产品？→ 补充信息 → 弱提示（之后再问）

Agent（强提示浮层）：
  ┌─────────────────────────────────────┐
  │  这份 PPT 给谁看？这会影响内容深度    │
  │                                     │
  │  [给领导汇报]  [团队内部分享]  [客户]  │
  └─────────────────────────────────────┘

（同时，状态栏已经显示：收集竞品 · 正在搜索...）
```

**关键设计决策：Agent 不等用户确认完再开始。** 能做的先做着（搜索已经开始了），需要决策的同步问。这和人类协作者的行为一致——不会傻等，也不会全部自作主张。

> **状态** `规划中` — 强提示浮层和 comment 系统均未实现

### 3.2 阶段二：调研收集

**触发条件：** Agent 开始搜索（可能在用户还没回答强提示时就已经开始）

**Agent 行为：** 搜索画布类产品，为每个产品生成一张独立的产品卡片放到画布上。

**用户看到什么：**

**执行过程中：**

```
输入栏上方状态条：
  ● 收集竞品 · 正在搜索画布类产品...        ━━━━━━░░░░
```

- 状态条是**静态文字 + 缓慢呼吸动画**，不闪烁不跳动
- 状态文字更新时平滑过渡，不重新挂载 DOM
- 输入框**始终可用**，用户可以同时下新任务：

```
输入栏上方状态条（多任务）：
  ● 收集竞品 · 已搜索到 23 个结果...         ━━━━━━━░░░
  ● 搜索论文 · 正在搜索...                   ━━░░░░░░░░
```

**产出物出现：**

Agent 搜索完成后，产品卡片逐张出现在画布上，4 列网格排列。

```
画布上：
  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
  │▌Figma    │  │▌Miro     │  │▌tldraw   │  │▌Notion   │
  │ 实时协作  │  │ 在线白板  │  │ 开源画布  │  │ 块编辑器  │
  │ 设计工具  │  │ 协作平台  │  │ 引擎     │  │ 一体化   │
  │ [设计][协作]│ │ [白板]   │  │ [开源]   │  │ [知识]   │
  │───────────│  │──────────│  │──────────│  │──────────│
  │🔍基于3篇  │  │🔍基于2篇  │  │🔍基于3篇  │  │🔍基于2篇  │
  │分析·figma │  │分析·miro │  │分析·github│  │分析·notion│
  │.com等     │  │.com等    │  │.com等    │  │.so等     │
  └──────────┘  └──────────┘  └──────────┘  └──────────┘
```

**卡片信息层级（三层）：**

| 层级 | 内容 | 用户行为 | 目的 |
|------|------|---------|------|
| **表面层**（折叠态） | 产品名 + 一句话 + 标签 + 来源摘要 | 扫一眼 | 快速判断"这是什么、值不值得看" |
| **展开层** | 完整 Markdown 分析 + 来源列表 | 点击展开按钮 | 查看 Agent 的分析细节 |
| **报告弹窗** | 大字排版的完整分析 + 可点击跳转的原文链接 | 点击"查看报告" | 验证信息真实性、阅读原文 |

**信任标记设计：**

普通用户需要相信 Agent 产出的内容是有依据的。信任通过两层建立：

- **折叠态底部**：来源摘要（"🔍 基于 3 篇文章分析 · figma.com、producthunt.com 等"）— 一眼看到有来源
- **报告弹窗**：每条来源显示文章标题、域名，点击可跳转原文 — 用户可以亲自验证

```
来源摘要（折叠态）：
  🔍 基于 3 篇文章分析 · figma.com、producthunt.com 等 3 个来源   查看报告 →

报告弹窗（点击后）：
  ┌─────────────────────────────────────────┐
  │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━（色条）   │
  │                                         │
  │  Figma                             [✕]  │
  │  实时协作设计工具，无限画布+组件系统       │
  │  [设计工具] [实时协作] [组件系统]          │
  │                                         │
  │  ─────────────────────────────────       │
  │  ## 核心亮点                              │
  │  · 多人实时协作：光标跟随、实时编辑        │
  │  · Auto Layout：自动布局系统              │
  │  · Dev Mode：设计到开发交付               │
  │  ...                                     │
  │                                         │
  │  ─────────────────────────────────       │
  │  参考来源 · 3 篇                          │
  │  ┌───────────────────────────────┐       │
  │  │🔗 Figma: The Collaborative... │       │
  │  │   figma.com · 点击查看原文  ↗  │       │
  │  └───────────────────────────────┘       │
  │  ┌───────────────────────────────┐       │
  │  │🔗 Figma Review 2025...       │       │
  │  │   producthunt.com · 点击查看  ↗│       │
  │  └───────────────────────────────┘       │
  └─────────────────────────────────────────┘
```

> **状态** `已实现` — 产品卡片（折叠/展开）、来源摘要、报告弹窗、多任务状态条均已在原型中实现

### 3.3 阶段三：用户筛选与整理

**触发条件：** 产品卡片已出现在画布上，用户开始操作。

**这个阶段的核心价值：** 在对话式 AI 里，用户只能说"去掉第 3 个和第 5 个"。在画布上，用户直接删。不需要用文字描述，操作本身就是指令。

**用户的画布操作 = 与 Agent 的沟通：**

| 画布操作 | 等于在说 | Agent 应如何响应 |
|---------|---------|----------------|
| **删除卡片** | "这个不要" | 后续分析排除该产品 |
| **拖动排序** | "我觉得这几个更重要" | 感知优先级（靠上/靠左 = 更重要） |
| **拖到一起成组** | "这些是一类" | 识别用户的分类意图 |
| **框选多张 + 输入** | "基于这些做什么" | 用框选内容作为上下文执行新任务 |
| **展开某张卡片** | "我对这个感兴趣" | 可触发深入研究建议（comment） |

**框选交互的详细设计：**

用户框选 3 张卡片（Figma、Miro、tldraw），然后在输入框说"帮我对比这三个的技术架构"：

```
画布上：
  ┌─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┐
  ╎  ┌──────────┐  ┌──────────┐  ┌──────────┐ ╎
  ╎  │▌Figma    │  │▌Miro     │  │▌tldraw   │ ╎   ← 框选范围
  ╎  │ ...      │  │ ...      │  │ ...      │ ╎
  ╎  └──────────┘  └──────────┘  └──────────┘ ╎
  └─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┘

  输入栏：对比这三个的技术架构  [→]
```

Agent 识别到框选的 3 张卡片作为上下文，执行对比分析。产出物（对比表格或分析卡片）出现在这 3 张卡片附近。

**Agent 的主动性（弱提示 / Comment）：**

Agent 观察到用户的操作后，可以主动提出建议，但用 comment 方式，不打断：

```
用户删掉了 Notion 和 Obsidian Canvas（两个知识管理工具）

Agent 在剩余卡片区域留一个 comment 气泡：
  💬 "你去掉了知识管理方向的产品。PPT 里要不要提一句为什么排除这类？"
     [好主意]  [不需要]  [稍后再说]
```

Comment 的设计参考 Figma 评论模式：
- 钉在相关内容的位置上
- 有未读标记（小圆点）
- 用户可以 resolve（解决后视觉收敛）
- **不阻塞任何操作**——用户可以完全无视

> **状态** `规划中` — 画布操作触发 Agent、框选交互、Comment 系统均未实现。卡片的拖动和删除依赖 tldraw 原生能力（已可用）。

### 3.4 阶段四：深入研究

**触发条件：** 用户对某张卡片说"深入研究"（通过框选+输入、卡片上下文菜单、或直接在输入栏指名）。

**场景示例：** 用户指着 Lovart 卡片说"这个的交互模式再深入研究一下"。

**Agent 行为：**

1. 针对 Lovart 进行深入搜索（更多来源、更详细的分析）
2. 产出物出现在 **Lovart 卡片附近**——空间位置表达从属关系

```
画布上（深入研究前）：
  ┌──────────┐
  │▌Lovart   │
  │ AI设计   │
  │ Agent    │
  └──────────┘

画布上（深入研究后）：
  ┌──────────┐
  │▌Lovart   │
  │ AI设计   │
  │ Agent    │
  └──────────┘
        │
        ├── ┌──────────────┐
        │   │ Talk.Tab.Tune│  ← 子卡片：交互模式分析
        │   │ 三层递进交互  │
        │   └──────────────┘
        │
        ├── ┌──────────────┐
        │   │ Canvas as    │  ← 子卡片：画布即上下文
        │   │ Context 分析  │
        │   └──────────────┘
        │
        └── ┌──────────────┐
            │ 用户评价摘要  │  ← 子卡片：市场反馈
            │ ProductHunt  │
            └──────────────┘
```

**空间布局原则：**

- 深入研究的产出物出现在**父卡片的右侧或下方**
- 子卡片和父卡片之间用**空间邻近性**暗示关系（不用连线，先验证空间是否足够表达）
- 如果空间邻近不够明确，后续考虑轻量连线

**深入研究可以递归：**

用户可以对子卡片继续说"再深入"——产出物出现在子卡片附近，形成层级结构。画布的无限空间天然支持这种展开。

**多任务并行在这里的价值：**

用户可以同时对多张卡片发起深入研究：

```
状态栏：
  ● 深入Lovart · 正在搜索交互模式...         ━━━━━░░░░░
  ● 深入Krea · 正在搜索实时渲染技术...        ━━━░░░░░░░
```

两组子卡片分别出现在各自父卡片附近，互不干扰。

> **状态** `规划中` — 深入研究流程、子卡片空间布局、递归展开均未实现

### 3.5 阶段五：组织大纲

**触发条件：** 用户觉得素材收集得差不多了，说"帮我组织成 PPT 大纲"。或者 Agent 观察到用户已经筛选整理完毕，主动用 comment 建议："素材看起来整理好了，要开始组织 PPT 大纲吗？"

**Agent 行为：**

Agent 分析画布上现有的所有卡片（用户筛选后留下的），结合用户在阶段一回答的受众信息，生成一份 PPT 大纲。

**大纲的呈现：新卡片类型 —— 大纲卡片**

大纲不是产品卡片，而是一种新的卡片类型，呈现 PPT 的页面结构：

```
画布上：

  ┌─────────────────────────────────────────┐
  │  📋 PPT 大纲：画布产品竞品分析             │
  │                                         │
  │  1. 封面                                 │
  │  2. 市场概览 ·························→  │  ← 可拖拽排序
  │  3. 产品矩阵（按交互模式分类）             │
  │  4. 重点产品：Figma ·········→  [Figma卡片] │  ← 关联到画布上的卡片
  │  5. 重点产品：Lovart ········→  [Lovart卡片]│
  │  6. 重点产品：Krea ··········→  [Krea卡片]  │
  │  7. 交互模式对比                          │
  │  8. 我们的机会                            │
  │  9. 下一步行动                            │
  │                                         │
  │  [调整大纲]  [开始生成]                    │
  └─────────────────────────────────────────┘
```

**大纲卡片的交互：**

- 每个条目可**拖拽排序**
- 条目可**关联到画布上已有的卡片**（虚线连接，表示"这页用这个素材"）
- 用户可以**直接编辑条目文字**（改标题、加减页）
- 点击条目 → 画布自动 zoom 到关联的素材卡片

**这里的强提示场景：**

大纲涉及 PPT 的结构决策，Agent 应该提出关键问题：

```
强提示浮层：
  ┌─────────────────────────────────────┐
  │  PPT 预计 9 页，几个结构选择：         │
  │                                     │
  │  重点产品放几个？                      │
  │  [3个（推荐）]  [5个]  [全部放]       │
  │                                     │
  │  要不要加"我们的定位"这页？            │
  │  [要]  [不要]                        │
  └─────────────────────────────────────┘
```

> **状态** `规划中` — 大纲卡片类型、拖拽排序、卡片关联均未实现

### 3.6 阶段六：生成页面内容

**触发条件：** 用户确认大纲后，点击"开始生成"或说"可以了，帮我生成"。

**Agent 行为：**

根据大纲逐页生成 PPT 内容。每一页的内容以**页面卡片**的形式出现在画布上。

**页面卡片 —— 又一种新卡片类型：**

页面卡片模拟 PPT 幻灯片的视觉，让用户直接在画布上预览 PPT 的样子：

```
画布上（生成过程中，逐页出现）：

  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐
  │  1. 封面     │  │  2. 市场概览  │  │  3. 产品矩阵 │
  │             │  │             │  │             │
  │  画布产品    │  │  · 市场规模  │  │  [表格]      │
  │  竞品分析    │  │  · 增长趋势  │  │  按交互模式   │
  │             │  │  · 主要玩家  │  │  分类...     │
  │  2026.01    │  │             │  │             │
  │   ▸ 1/9     │  │   ▸ 2/9     │  │   ▸ 3/9     │
  └─────────────┘  └─────────────┘  └─────────────┘

  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐
  │ 4. Figma    │  │ 5. Lovart   │  │ 6. Krea     │
  │             │  │             │  │             │
  │  核心亮点：  │  │  核心亮点：  │  │  核心亮点：   │
  │  · 实时协作  │  │  · Talk.Tab │  │  · 实时渲染  │
  │  · 组件系统  │  │  · Tune     │  │  · <50ms    │
  │  · ...      │  │  · ...      │  │  · ...      │
  │   ▸ 4/9     │  │   ▸ 5/9     │  │   ▸ 6/9     │
  └─────────────┘  └─────────────┘  └─────────────┘
```

**页面卡片的交互：**

- **点击编辑**：直接在卡片上修改文字内容
- **拖拽排序**：调整页面顺序
- **删除**：去掉不要的页面
- **对某页说话**：框选某页 + 输入"这页加一个对比图表" → Agent 更新该页内容
- **来源追溯**：每页内容关联到它引用的产品卡片/来源

**生成过程中的状态：**

```
状态栏：
  ● 生成PPT · 第 4/9 页 · Figma 详情...     ━━━━━━━░░░

画布上，已生成的页面逐张出现，未生成的位置灰色占位
```

**画布的优势在这里充分体现：**

在对话式 AI 里，9 页 PPT 内容会是一段很长的文字输出，用户只能从上往下读。在画布上：
- 所有页面**同时可见**，像真实 PPT 的缩略图视图
- 可以**随时对比**任意两页的内容
- 可以**直接拖动**调整页面顺序
- 修改某页时**不影响其他页**的可见性

> **状态** `规划中` — 页面卡片类型、页内编辑、来源追溯均未实现

### 3.7 阶段七：导出 PPT

**触发条件：** 用户对页面内容满意后，说"导出 PPT"或点击大纲卡片上的"导出"按钮。

**Agent 行为：**

将画布上的页面卡片按顺序转换为真正的 .pptx 文件。

**导出前的确认（强提示）：**

```
强提示浮层：
  ┌─────────────────────────────────────┐
  │  准备导出 9 页 PPT，确认几个选项：     │
  │                                     │
  │  页面尺寸                            │
  │  [16:9（推荐）]  [4:3]              │
  │                                     │
  │  视觉风格                            │
  │  [简洁商务]  [深色科技]  [自定义]     │
  └─────────────────────────────────────┘
```

**导出过程：**

```
状态栏：
  ● 导出PPT · 正在渲染第 4/9 页...        ━━━━━━░░░░
```

**导出完成：**

```
画布上出现一张「文件卡片」：
  ┌─────────────────────┐
  │  📄 画布产品竞品分析.pptx │
  │                     │
  │  9 页 · 16:9 · 2.3MB │
  │                     │
  │  [下载]  [预览]      │
  └─────────────────────┘
```

**导出不是终点——画布是持续工作空间：**

导出后，画布上的所有素材（产品卡片、研究子卡片、大纲、页面卡片）都还在。用户可以：

- 收到反馈后，回到画布修改某页内容，重新导出
- 继续深入研究某个产品，补充新素材
- 复用这些素材做新的 PPT

这是画布相比对话的另一个优势：**对话是一次性的，画布是持续的工作空间**。

> **状态** `规划中` — 导出功能未实现。依赖页面卡片内容结构化和 PPT 渲染引擎（如 pptxgenjs）

## 4. 通用能力抽象

PPT 场景验证的是一条具体路径，但其中的交互模式和组件是通用的。以下将 PPT 路径中的能力抽象为可复用的通用能力层。

### 4.1 Agent 执行引擎

| 能力 | PPT 场景中的体现 | 通用描述 |
|------|----------------|---------|
| **多任务并行** | 同时收集竞品 + 搜索论文 | Agent 可同时执行多个独立任务，各自管理生命周期 |
| **状态栏反馈** | 每个任务一行：标签 + 状态文字 + 进度条 | 统一的任务进度可视化，不侵入画布空间 |
| **渐进式产出** | 搜索完一个产品就放一张卡片 | 不等所有结果出来再一次性呈现，边做边出 |

### 4.2 提示系统

| 能力 | PPT 场景中的体现 | 通用描述 |
|------|----------------|---------|
| **强提示** | "PPT 给谁看？" / "重点产品放几个？" | 影响任务结果的决策，浮层呈现，必须回应 |
| **弱提示（Comment）** | "要不要提为什么排除知识管理类？" | 补充性建议，钉在画布相关位置，不阻塞 |
| **自动判断** | 搜索策略、卡片排列位置 | Agent 自行决策的事项，不打扰用户 |

**适用于任何场景**：写报告（"目标读者是谁？" → 强提示），做调研（"要不要覆盖学术论文？" → 弱提示），写代码（选择技术栈 → 强提示）。

### 4.3 卡片系统

| 卡片类型 | PPT 场景中的角色 | 通用抽象 |
|---------|----------------|---------|
| **内容卡片** | 产品卡片（Figma、Miro...） | 任何 Agent 产出的独立内容单元 |
| **结构卡片** | 大纲卡片 | 内容的组织结构，可排序、可关联 |
| **页面卡片** | PPT 单页 | 最终交付物的预览单元 |
| **文件卡片** | 导出的 .pptx | 最终产出物的下载入口 |

**通用卡片能力**（所有卡片类型共享）：

- **三层信息层级**：表面层（扫一眼）→ 展开层（细节）→ 弹窗层（完整报告）
- **信任标记**：来源摘要 + 可点击原文链接
- **空间语义**：位置表达关系（邻近 = 相关，远离 = 独立）
- **可操作性**：拖动、删除、框选、编辑

### 4.4 画布操作语义

| 操作 | 通用含义 | 适用场景 |
|------|---------|---------|
| **删除** | "不要这个" | 任何筛选场景 |
| **拖动排序** | "这个更重要/不重要" | 任何有优先级的场景 |
| **拖到一起** | "这些是一组" | 任何分类场景 |
| **框选 + 输入** | "基于这些做 X" | 任何需要上下文的指令 |
| **展开/查看** | "我对这个感兴趣" | 触发深入研究建议 |

这套操作语义不需要为每个场景重新设计。用户学会一次，在所有场景中通用。

### 4.5 其他场景示例

用同样的能力组合，可以支持：

**写技术方案**
- 收集阶段：搜索相关技术文章 → 内容卡片
- 筛选阶段：删除不相关的，框选说"对比这几个方案的性能"
- 组织阶段：大纲卡片（架构 → 实现 → 测试 → 部署）
- 生成阶段：每章节一张页面卡片
- 导出：Markdown / Google Doc

**做市场调研**
- 收集阶段：搜索行业数据 → 数据卡片（图表 + 数字）
- 深入阶段：对某个数据点"展开" → 搜索原始来源
- 组织：报告大纲
- 导出：PDF 报告

**核心模式不变**：收集 → 筛选 → 深入 → 组织 → 生成 → 导出。变化的只是卡片内容和最终交付格式。

## 5. 实现状态

### 5.1 已实现（原型验证）

| 能力 | 实现方式 | 对应阶段 |
|------|---------|---------|
| **产品卡片** | `ProductCardShape` — tldraw 自定义 Shape，支持折叠/展开 | 阶段二 |
| **三层信息层级** | 折叠态（名称+标签+来源摘要）→ 展开态（Markdown 详情）→ 报告弹窗 | 阶段二 |
| **信任标记** | 来源摘要（"🔍 基于 N 篇分析 · 域名列表"）+ 报告弹窗中可点击原文链接 | 阶段二 |
| **多任务并行** | `AgentInputBar` 接受 `tasks: AgentTask[]`，独立显示每个任务进度 | 阶段二/四 |
| **状态栏反馈** | 呼吸动画（2s 周期） + 平滑文字过渡 + 可选进度条 | 阶段二 |
| **输入不阻塞** | 输入框始终可用，任务执行期间可继续提交新任务 | 全局 |
| **Agent 过程卡片** | `AgentCardShape` — 简化版，仅展示 thinking + tool_call 步骤 | 阶段二（已移除过程上画布，保留代码） |
| **Mock 数据** | `agentMockData.ts` — 产品搜索场景 mock，8 个产品含来源引用 | 阶段二 |

### 5.2 未实现（按优先级）

**P0 — 核心交互闭环**

| 能力 | 说明 | 对应阶段 |
|------|------|---------|
| 强提示浮层 | 输入栏上方选项面板，阻塞式 | 阶段一/五/七 |
| 框选 + 输入 | 检测框选内容，作为 Agent 上下文 | 阶段三 |
| 删除感知 | Agent 识别用户删除的卡片，调整后续行为 | 阶段三 |

**P1 — 完整 PPT 路径**

| 能力 | 说明 | 对应阶段 |
|------|------|---------|
| Comment 系统 | Agent 弱提示，钉在画布上，可 resolve | 阶段三 |
| 深入研究 | 对卡片发起二次搜索，子卡片就近布局 | 阶段四 |
| 大纲卡片 | 新卡片类型，可拖拽排序、关联素材卡片 | 阶段五 |
| 页面卡片 | PPT 单页预览，可编辑内容 | 阶段六 |
| PPT 导出 | 页面卡片 → .pptx 文件 | 阶段七 |

**P2 — 体验增强**

| 能力 | 说明 |
|------|------|
| 真实 AI 后端 | 替换 mock，接入 Claude API + 搜索工具 |
| 画布操作语义识别 | Agent 理解拖动、成组等空间操作的含义 |
| 来源追溯连线 | 页面卡片到素材卡片的视觉关联 |
| 持久化 | 画布状态保存和恢复 |

## 6. 附录

### 6.1 竞品参考

| 产品 | 与 Canvas Agent 的关系 | 值得借鉴的点 |
|------|----------------------|------------|
| **Figma + FigJam** | 无限画布 + 协作的标杆 | 评论系统（钉在位置上、可 resolve）、光标存在感、组件交互精度 |
| **Miro** | 白板协作，模板丰富 | 框架分区、便签操作、会议辅助工具（投票/计时）|
| **tldraw** | 本项目的画布引擎 | 自定义 Shape 系统、轻量可嵌入、开发者友好的 API |
| **Cursor / Windsurf** | AI 代码编辑器，对话+编辑融合 | 内联操作（Accept/Reject）、过程可见但不侵入、multi-file diff |
| **Lovart** | AI 设计 Agent，画布上协作 | Talk-Tab-Tune 三层递进交互、Canvas as Context |
| **Perplexity** | AI 搜索，信任标记做得好 | 来源引用的展示方式、"基于 N 个来源"的信任暗示 |
| **Heptabase** | 视觉化知识管理 | 卡片+白板的融合、空间位置表达关系、多层嵌套 |

### 6.2 设计决策记录

在原型实现过程中做出的关键设计决策，及其原因：

**1. 过程不上画布**
- **决策**：Agent 的思考和工具调用过程只在状态栏显示，不作为卡片放到画布上
- **原因**：过程信息是临时的、用户不需要反复查看。放到画布上会占空间、抢注意力。用户关心的是结果，不是过程
- **替代方案被否**：之前的设计是创建一张"过程卡片"在画布上逐步填充步骤 → 用户反馈认为这污染了画布空间

**2. 状态栏用呼吸动画而不是脉冲**
- **决策**：2 秒周期的缓慢呼吸，而不是 1.2 秒的闪烁脉冲
- **原因**：实际场景中 Agent 的思考步骤和工具调用会很多，快速闪烁会"闪瞎用户"。缓慢呼吸表达"正在工作"即可

**3. 输入框永不禁用**
- **决策**：任务执行期间输入框始终可用
- **原因**：用户可能随时想下新任务。阻塞输入等于强迫用户等待，违反"多任务并行"原则

**4. 信任标记用来源摘要而不是评分**
- **决策**：显示"基于 N 篇文章 · 具体域名"，而不是"可信度 85%"
- **原因**：用户不信任 AI 自我评估的"可信度分数"。展示具体来源让用户自己判断

**5. 三层信息层级而不是两层**
- **决策**：折叠（扫一眼）→ 展开（细节）→ 弹窗（完整报告+原文链接）
- **原因**：两层不够——折叠态太简略无法校验，展开态塞入原文链接会让卡片过长。弹窗层专门用于"验证信息真实性"这个独立任务

**6. 强/弱提示分级而不是统一弹窗**
- **决策**：影响结果的问题用强提示（必须回答），补充信息用 comment（可忽略）
- **原因**：如果所有问题都用弹窗，用户会被打断太多次。分级让 Agent 像人类协作者一样：重要的当面问，不重要的留个便签
